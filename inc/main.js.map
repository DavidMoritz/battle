{"version":3,"sources":["main.js"],"names":["mainApp","angular","module","config","apiKey","authDomain","databaseURL","storageBucket","firebase","initializeApp","run","runWithDependencies","$rootScope","_","mc","controller","MainCtrl","$s","$timeout","$interval","$uibM","CF","EF","FF","init","window","joinableGames","mapKeys","allGames","game","key","name","playerIds","indexOf","currentUser","uid","public","active","skip","state","chatList","listenToChat","latestChat","getFBObject","stopChat","$watch","push","clone","createNewUser","id","data","allUsers","$loaded","$save","restartTurn","activeGame","currentPlayer","allPlayers","joinActiveGame","updateGame","eventTracker","events","length","reduce","prevEvent","then","runEvent","idx","event","eventFunction","Promise","bind","shuffleDeck","deck","sort","a","b","gameNumber","parseInt","firstCardNum","secondCardNum","openModal","resolve","modalInstance","open","animation","templateUrl","toLowerCase","size","assign","battleHistory","ff","gameName","getBattleCount","subEvents","slice","submitEvents","partition","Math","floor","notify","message","type","clearTimeout","cancelMessage","text","setTimeout","submitChat","chat","user","firstName","submitCards","addEvent","cards","selectedCards","battleCount","timestamp","Date","getTime","changeState","createNewGame","rand","random","toString","substring","$ref","update","hostId","$bindTo","playerNames","selectCard","card","selected","viewCard","fbLogin","facebookLogin","console","log","err","authData","providerData","displayName","rating","first_name","googleLogin","$","addClass","ModalCtrl","$scope","$uibModalInstance","cancel","dismiss","factory","CardFactory","yellow","value","class","color","purple","cyan","orange","resources","symbol","description","story","strength","abilities","cost","canoe","short","benefit","river","wood","fur","horse","meat","collect","equipment","mountain","stroy","winner","allCards","concat","CFactory","allColors","ClassFactory","Corp","energy","mineral","food","Deck","activeCardId","cardId","find","map","played","plays","cardInfo","findIndex","splice","total","heldCards","filter","max","Player","options","corp","collectables","payment","reset","cardSet","forEach","playCard","play","item","EventFactory","Class","gameCreated","startGame","users","chooseBattle","findById","closeModal","close","submitBattle","keys","battle","count","player","battlePower","playCardSet","determineWinner","i","nextPlayer","duplicateBattlePower","takeResource","FirebaseFactory","$fbArray","$fbObject","FB","getFB","database","ref","childPath","child","getFBArray","getAuth","$firebaseAuth","setFB","set","success","provider","auth","GoogleAuthProvider","signInWithPopup","result","catch","error","FacebookAuthProvider","addScope","pluralize","str","replace","camelToTitle","capitalize","trim","randomDigits","min","undefined","alphabet","split","isAngularObjectEqual","object1","object2","isEqual","omit","expandArray","array","times","expandedArray","copy","calculateAge","dateOfBirth","age","year","Number","substr","month","day","today","getFullYear","getMonth","getDate"],"mappings":"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","file":"main.js","sourcesContent":["/*!\r\n * A new battle game by David Wintterle - v0.0.1 \r\n * Build Date: 2016.10.19 \r\n * Docs: http://moritzcompany.com \r\n * Coded @ Moritz Company \r\n */ \r\n \r\nvar mainApp = angular.module('mainApp', ['firebase', 'ui.bootstrap']);\r\n\r\nmainApp.config(() => {\r\n\tvar config = {\r\n\t\tapiKey: 'AIzaSyD6S7XI77nZX1yabhWapmLggdykUnJxwH8',\r\n\t\tauthDomain: 'battle-74684.firebaseapp.com',\r\n\t\tdatabaseURL: 'https://battle-74684.firebaseio.com',\r\n\t\tstorageBucket: 'gs://battle-74684.appspot.com'\r\n\t};\r\n\tfirebase.initializeApp(config);\r\n});\r\n\r\nmainApp.run(function runWithDependencies($rootScope) {\r\n\t$rootScope._ = _;\r\n\t$rootScope.mc = mc;\r\n});\r\nmainApp.controller('MainCtrl', [\r\n\t'$scope',\r\n\t'$timeout',\r\n\t'$interval',\r\n\t'$uibModal',\r\n\t'ClassFactory',\r\n\t'EventFactory',\r\n\t'FirebaseFactory',\r\n\tfunction MainCtrl($s, $timeout, $interval, $uibM, CF, EF, FF) {\r\n\t\t'use strict';\r\n\r\n\t\tfunction init() {\r\n\t\t\t//\tinit stuff\r\n\t\t\twindow.$s = $s;\r\n\r\n\t\t\t$s.joinableGames = _.mapKeys($s.allGames, (game, key) => {\r\n\t\t\t\tif (typeof game === 'object' && game && game.name) {\r\n\t\t\t\t\tswitch (true) {\r\n\t\t\t\t\t\tcase (game.playerIds.indexOf($s.currentUser.uid) !== -1):\r\n\t\t\t\t\t\tcase (game.public && !game.active):\r\n\t\t\t\t\t\t\treturn key;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn 'skip';\r\n\t\t\t});\r\n\t\t\tdelete $s.joinableGames.skip;\r\n\r\n\t\t\t$s.state = 'joinGame';\r\n\t\t\t$s.chatList = [];\r\n\t\t}\r\n\r\n\t\tfunction listenToChat() {\r\n\t\t\twindow.latestChat = FF.getFBObject('message');\r\n\t\t\twindow.stopChat = latestChat.$watch(() => {\r\n\t\t\t\t$s.chatList.push(_.clone(latestChat));\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction createNewUser(id, data) {\r\n\t\t\tvar allUsers = FF.getFBObject('users');\r\n\r\n\t\t\tallUsers.$loaded(() => {\r\n\t\t\t\tallUsers[id] = data;\r\n\t\t\t\tallUsers.$save();\r\n\t\t\t\t$s.currentUser = allUsers[id];\r\n\t\t\t\tinit();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction restartTurn() {\r\n\t\t\t// this is not working.\r\n\t\t\tvar id = $s.activeGame.id;\r\n\t\t\t$s.currentPlayer = null;\r\n\t\t\t$s.allPlayers = [];\r\n\t\t\t$s.activeGame = {};\r\n\t\t\t$s.restartTurn = false;\r\n\t\t\t$s.joinActiveGame({id: id});\r\n\t\t}\r\n\r\n\t\tfunction updateGame() {\r\n\t\t\tif ($s.restartTurn) {\r\n\t\t\t\trestartTurn();\r\n\t\t\t} else if ($s.eventTracker < $s.activeGame.events.length) {\r\n\t\t\t\t$s.activeGame.events.reduce(prevEvent => {\r\n\t\t\t\t\treturn prevEvent.then(() => {\r\n\t\t\t\t\t\treturn runEvent(++$s.eventTracker);\r\n\t\t\t\t\t}, () => $s);\r\n\t\t\t\t}, runEvent($s.eventTracker));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction runEvent(idx) {\r\n\t\t\tif (idx >= $s.activeGame.events.length) {\r\n\t\t\t\t$s.eventTracker = $s.activeGame.events.length;\r\n\t\t\t\t// return meaningless function to avoid error\r\n\t\t\t\treturn {then: () => 0};\r\n\t\t\t}\r\n\t\t\tvar event = $s.activeGame.events[idx];\r\n\t\t\tvar eventFunction = EF[event.name];\r\n\r\n\t\t\treturn new Promise(eventFunction.bind(event));\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Shuffle Deck\r\n\t\t * The game needs to shuffle the cards in a predictable way\r\n\t\t * so that every user gets the same outcome. This is done by\r\n\t\t * 'seeding' the algorithm with the randomly generated gameId.\r\n\t\t * This algorthim has been tested over larger iterations here:\r\n\t\t * https://jsfiddle.net/sr7djh8x/6/\r\n\t\t */\r\n\t\tfunction shuffleDeck(deck) {\r\n\t\t\treturn deck.sort((a, b) => {\r\n\t\t\t\tvar gameNumber = parseInt($s.activeGame.id, 36);\r\n\t\t\t\tvar firstCardNum = parseInt(a.id, 36);\r\n\t\t\t\tvar secondCardNum = parseInt(b.id, 36);\r\n\r\n\t\t\t\treturn (gameNumber % firstCardNum) - (gameNumber % secondCardNum);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction openModal(name, resolve) {\r\n\t\t\t$s.modalInstance = $uibM.open({\r\n\t\t\t\tanimation: true,\r\n\t\t\t\ttemplateUrl: name.toLowerCase() + 'Modal',\r\n\t\t\t\tcontroller: name + 'ModalInstanceCtrl',\r\n\t\t\t\tsize: 'lg',\r\n\t\t\t\tresolve: resolve\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t_.assign($s, {\r\n\t\t\tstate: 'welcome',\r\n\t\t\tallPlayers: [],\r\n\t\t\tchatList: [],\r\n\t\t\tbattleHistory: [],\r\n\t\t\tactiveGame: {},\r\n\t\t\teventTracker: 0,\r\n\t\t\tff: {\r\n\t\t\t\tgameName: 'newGame'\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$s.getBattleCount = () => {\r\n\t\t\tvar subEvents = $s.activeGame.events.slice(0, $s.eventTracker);\r\n\t\t\tvar submitEvents = _.partition(subEvents, {name: 'submitBattle'})[0].length;\r\n\r\n\t\t\tif ($s.allPlayers.length == 1) {\r\n\t\t\t\treturn submitEvents;\r\n\t\t\t}\r\n\r\n\t\t\treturn Math.floor(submitEvents / $s.allPlayers.length);\r\n\t\t};\r\n\r\n\t\t$s.notify = (message, type) => {\r\n\t\t\tclearTimeout($s.cancelMessage);\r\n\t\t\ttype = type || 'info';\r\n\r\n\t\t\t$s.activeGame.message = {\r\n\t\t\t\ttext: message,\r\n\t\t\t\ttype: type\r\n\t\t\t};\r\n\r\n\t\t\t$s.cancelMessage = setTimeout(() => {\r\n\t\t\t\t$s.activeGame.message = {};\r\n\t\t\t}, 4000);\r\n\t\t};\r\n\r\n\t\t$s.submitChat = () => {\r\n\t\t\tif (!$s.ff.chat.length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlatestChat.user = $s.currentUser.firstName;\r\n\t\t\tlatestChat.text = $s.ff.chat;\r\n\t\t\tlatestChat.$save();\r\n\t\t\t$s.ff.chat = '';\r\n\t\t};\r\n\r\n\t\t$s.submitCards = () => {\r\n\t\t\t// disable submit button\r\n\t\t\t$s.addEvent({\r\n\t\t\t\tname: 'submitBattle',\r\n\t\t\t\tcards: $s.user.deck.selectedCards,\r\n\t\t\t\tuid: $s.user.uid,\r\n\t\t\t\tbattleCount: $s.getBattleCount()\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t$s.addEvent = event => {\r\n\t\t\tif (typeof event == 'string') {\r\n\t\t\t\tevent = {name: event};\r\n\t\t\t}\r\n\t\t\tevent.timestamp = new Date().getTime();\r\n\t\t\t$s.activeGame.events.push(event);\r\n\t\t};\r\n\r\n\t\t$s.changeState = state => {\r\n\t\t\t$s.state = state;\r\n\t\t};\r\n\r\n\t\t$s.createNewGame = () => {\r\n\t\t\t// This should be separated based on something so that the\r\n\t\t\t// \"allGames\" doesn't just continue to grow.\r\n\t\t\t// maybe after a game is completed, it gets moved into an\r\n\t\t\t// archive of some sort rather than continue to be in here.\r\n\t\t\tvar rand = Math.random().toString(36).substring(2, 10);\r\n\t\t\tallGames.$ref().update({[rand]: {\r\n\t\t\t\tid: rand,\r\n\t\t\t\t//name: $s.ff.gameName,\r\n\t\t\t\tname: `${$s.currentUser.firstName}'s Game`,\r\n\t\t\t\ttimestamp: new Date().getTime(),\r\n\t\t\t\tevents: [{\r\n\t\t\t\t\tname: 'gameCreated'\r\n\t\t\t\t}],\r\n\t\t\t\thostId: $s.currentUser.uid,\r\n\t\t\t\tactive: false,\r\n\t\t\t\tpublic: true\r\n\t\t\t}}, () => {\r\n\t\t\t\t$s.joinActiveGame({id: rand});\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t$s.joinActiveGame = game => {\r\n\t\t\tif ($s.activeGame.id || !$s.currentUser) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar activeGame = FF.getFBObject(`allGames/${game.id}`);\r\n\t\t\tactiveGame.$bindTo($s, 'activeGame');\r\n\r\n\t\t\tactiveGame.$loaded(() => {\r\n\t\t\t\tif (!$s.activeGame.playerIds) {\r\n\t\t\t\t\t$s.activeGame.playerIds = [];\r\n\t\t\t\t\t$s.activeGame.playerNames = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($s.activeGame.playerIds.indexOf($s.currentUser.uid) === -1) {\r\n\t\t\t\t\t$s.activeGame.playerIds.push($s.currentUser.uid);\r\n\t\t\t\t\t$s.activeGame.playerNames.push($s.currentUser.name);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$s.battleHistory = [];\r\n\t\t\t\t$s.eventTracker = 0;\r\n\t\t\t\t$s.$watch('activeGame.events', updateGame);\r\n\t\t\t});\r\n\t\t\tstopChat();\r\n\t\t};\r\n\r\n\t\t$s.selectCard = card => {\r\n\t\t\tcard.selected = !card.selected;\r\n\t\t};\r\n\r\n\t\t$s.viewCard = card => {\r\n\t\t\topenModal('ViewCard', {\r\n\t\t\t\tcard: card\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t$s.fbLogin = () => {\r\n\t\t\tFF.facebookLogin(err => {\r\n\t\t\t\tconsole.log('There was a Facebook Login error', err);\r\n\t\t\t\t$s.notify('Facebook Login Error', 'danger');\r\n\t\t\t\t// ** TEMPORARY FOR DEV ***\r\n\t\t\t\t$s.currentUser = FF.getFBObject('users/DrocniTEYXeclP6n52ugMXEzAgF3');\r\n\t\t\t\t$s.currentUser.$loaded(init);\r\n\t\t\t\t// ** END TEMPORARY FOR DEV ***\r\n\t\t\t}, authData => {\r\n\t\t\t\tconsole.log('Authenticated successfully with payload:', authData);\r\n\t\t\t\t$s.currentUser = FF.getFBObject('users/' + authData.uid);\r\n\t\t\t\t$s.currentUser.$loaded(user => {\r\n\t\t\t\t\tif (!user.uid) {\r\n\t\t\t\t\t\tvar name = authData.providerData[0].displayName;\r\n\t\t\t\t\t\tcreateNewUser(authData.uid, {\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\trating: 1200,\r\n\t\t\t\t\t\t\tuid: authData.uid,\r\n\t\t\t\t\t\t\tfirstName: authData.providerData[0].first_name || name.substring(0, name.indexOf(' ')) || name\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tinit();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t$s.googleLogin = () => {\r\n\t\t\tFF.googleLogin(err => {\r\n\t\t\t\tconsole.log('There was a Google Login error', err);\r\n\t\t\t\t$s.notify('Google Login Error', 'danger');\r\n\t\t\t\t/* TEMP LOGIN */\r\n\t\t\t\t$s.currentUser = FF.getFBObject('users/dpnncrYpfoNkC4qcg5aNzNtBezS2');\r\n\t\t\t\t$s.currentUser.$loaded(init);\r\n\t\t\t\t/* END TEMP LOGIN */\r\n\t\t\t}, authData => {\r\n\t\t\t\tconsole.log('Authenticated successfully with payload:', authData);\r\n\t\t\t\t$s.currentUser = FF.getFBObject('users/' + authData.uid);\r\n\t\t\t\t$s.currentUser.$loaded(user => {\r\n\t\t\t\t\tif (!user.uid) {\r\n\t\t\t\t\t\tvar name = authData.providerData[0].displayName;\r\n\t\t\t\t\t\tcreateNewUser(authData.uid, {\r\n\t\t\t\t\t\t\tname: name,\r\n\t\t\t\t\t\t\trating: 1200,\r\n\t\t\t\t\t\t\tuid: authData.uid,\r\n\t\t\t\t\t\t\tfirstName: authData.providerData[0].first_name || name.substring(0, name.indexOf(' ')) || name\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tinit();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t// grab all the games and make sure Firebase is working!\r\n\t\twindow.allGames = FF.getFBObject('allGames');\r\n\t\tallGames.$bindTo($s, 'allGames');\r\n\t\tallGames.$loaded(() => {\r\n\t\t\t$('body').addClass('facebook-available');\r\n\t\t\tlistenToChat();\r\n\t\t});\r\n\t}\r\n]);\r\nmainApp.controller('ViewCardModalInstanceCtrl', function ModalCtrl($scope, $uibModalInstance, card) {\r\n\t$scope.card = card;\r\n\r\n\t$scope.cancel = () => $uibModalInstance.dismiss('cancel');\r\n});\r\nmainApp.factory('CardFactory', [\r\n\tfunction CardFactory() {\r\n\t\t'use strict';\r\n\r\n\t\treturn {\r\n\t\t\tyellow: [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'YB0',\r\n\t\t\t\t\tvalue: 0,\r\n\t\t\t\t\tclass: 'zero',\r\n\t\t\t\t\tcolor: 'yellow'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'YB1',\r\n\t\t\t\t\tvalue: 1,\r\n\t\t\t\t\tclass: 'one',\r\n\t\t\t\t\tcolor: 'yellow'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'YB2',\r\n\t\t\t\t\tvalue: 2,\r\n\t\t\t\t\tclass: 'two',\r\n\t\t\t\t\tcolor: 'yellow'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'YB3',\r\n\t\t\t\t\tvalue: 3,\r\n\t\t\t\t\tclass: 'three',\r\n\t\t\t\t\tcolor: 'yellow'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'YB4',\r\n\t\t\t\t\tvalue: 4,\r\n\t\t\t\t\tclass: 'four',\r\n\t\t\t\t\tcolor: 'yellow'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'YB5',\r\n\t\t\t\t\tvalue: 5,\r\n\t\t\t\t\tclass: 'five',\r\n\t\t\t\t\tcolor: 'yellow'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'YB6',\r\n\t\t\t\t\tvalue: 6,\r\n\t\t\t\t\tclass: 'six',\r\n\t\t\t\t\tcolor: 'yellow'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'YB7',\r\n\t\t\t\t\tvalue: 7,\r\n\t\t\t\t\tclass: 'seven',\r\n\t\t\t\t\tcolor: 'yellow'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'YB8',\r\n\t\t\t\t\tvalue: 8,\r\n\t\t\t\t\tclass: 'eight',\r\n\t\t\t\t\tcolor: 'yellow'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'YB9',\r\n\t\t\t\t\tvalue: 9,\r\n\t\t\t\t\tclass: 'nine',\r\n\t\t\t\t\tcolor: 'yellow'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'YB10',\r\n\t\t\t\t\tvalue: 10,\r\n\t\t\t\t\tclass: 'ten',\r\n\t\t\t\t\tcolor: 'yellow'\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tpurple: [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'PB0',\r\n\t\t\t\t\tvalue: 0,\r\n\t\t\t\t\tclass: 'zero',\r\n\t\t\t\t\tcolor: 'purple'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'PB1',\r\n\t\t\t\t\tvalue: 1,\r\n\t\t\t\t\tclass: 'one',\r\n\t\t\t\t\tcolor: 'purple'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'PB2',\r\n\t\t\t\t\tvalue: 2,\r\n\t\t\t\t\tclass: 'two',\r\n\t\t\t\t\tcolor: 'purple'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'PB3',\r\n\t\t\t\t\tvalue: 3,\r\n\t\t\t\t\tclass: 'three',\r\n\t\t\t\t\tcolor: 'purple'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'PB4',\r\n\t\t\t\t\tvalue: 4,\r\n\t\t\t\t\tclass: 'four',\r\n\t\t\t\t\tcolor: 'purple'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'PB5',\r\n\t\t\t\t\tvalue: 5,\r\n\t\t\t\t\tclass: 'five',\r\n\t\t\t\t\tcolor: 'purple'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'PB6',\r\n\t\t\t\t\tvalue: 6,\r\n\t\t\t\t\tclass: 'six',\r\n\t\t\t\t\tcolor: 'purple'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'PB7',\r\n\t\t\t\t\tvalue: 7,\r\n\t\t\t\t\tclass: 'seven',\r\n\t\t\t\t\tcolor: 'purple'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'PB8',\r\n\t\t\t\t\tvalue: 8,\r\n\t\t\t\t\tclass: 'eight',\r\n\t\t\t\t\tcolor: 'purple'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'PB9',\r\n\t\t\t\t\tvalue: 9,\r\n\t\t\t\t\tclass: 'nine',\r\n\t\t\t\t\tcolor: 'purple'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'PB10',\r\n\t\t\t\t\tvalue: 10,\r\n\t\t\t\t\tclass: 'ten',\r\n\t\t\t\t\tcolor: 'purple'\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tcyan: [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'CB0',\r\n\t\t\t\t\tvalue: 0,\r\n\t\t\t\t\tclass: 'zero',\r\n\t\t\t\t\tcolor: 'cyan'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'CB1',\r\n\t\t\t\t\tvalue: 1,\r\n\t\t\t\t\tclass: 'one',\r\n\t\t\t\t\tcolor: 'cyan'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'CB2',\r\n\t\t\t\t\tvalue: 2,\r\n\t\t\t\t\tclass: 'two',\r\n\t\t\t\t\tcolor: 'cyan'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'CB3',\r\n\t\t\t\t\tvalue: 3,\r\n\t\t\t\t\tclass: 'three',\r\n\t\t\t\t\tcolor: 'cyan'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'CB4',\r\n\t\t\t\t\tvalue: 4,\r\n\t\t\t\t\tclass: 'four',\r\n\t\t\t\t\tcolor: 'cyan'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'CB5',\r\n\t\t\t\t\tvalue: 5,\r\n\t\t\t\t\tclass: 'five',\r\n\t\t\t\t\tcolor: 'cyan'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'CB6',\r\n\t\t\t\t\tvalue: 6,\r\n\t\t\t\t\tclass: 'six',\r\n\t\t\t\t\tcolor: 'cyan'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'CB7',\r\n\t\t\t\t\tvalue: 7,\r\n\t\t\t\t\tclass: 'seven',\r\n\t\t\t\t\tcolor: 'cyan'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'CB8',\r\n\t\t\t\t\tvalue: 8,\r\n\t\t\t\t\tclass: 'eight',\r\n\t\t\t\t\tcolor: 'cyan'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'CB9',\r\n\t\t\t\t\tvalue: 9,\r\n\t\t\t\t\tclass: 'nine',\r\n\t\t\t\t\tcolor: 'cyan'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'CB10',\r\n\t\t\t\t\tvalue: 10,\r\n\t\t\t\t\tclass: 'ten',\r\n\t\t\t\t\tcolor: 'cyan'\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\torange: [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'OB0',\r\n\t\t\t\t\tvalue: 0,\r\n\t\t\t\t\tclass: 'zero',\r\n\t\t\t\t\tcolor: 'orange'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'OB1',\r\n\t\t\t\t\tvalue: 1,\r\n\t\t\t\t\tclass: 'one',\r\n\t\t\t\t\tcolor: 'orange'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'OB2',\r\n\t\t\t\t\tvalue: 2,\r\n\t\t\t\t\tclass: 'two',\r\n\t\t\t\t\tcolor: 'orange'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'OB3',\r\n\t\t\t\t\tvalue: 3,\r\n\t\t\t\t\tclass: 'three',\r\n\t\t\t\t\tcolor: 'orange'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'OB4',\r\n\t\t\t\t\tvalue: 4,\r\n\t\t\t\t\tclass: 'four',\r\n\t\t\t\t\tcolor: 'orange'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'OB5',\r\n\t\t\t\t\tvalue: 5,\r\n\t\t\t\t\tclass: 'five',\r\n\t\t\t\t\tcolor: 'orange'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'OB6',\r\n\t\t\t\t\tvalue: 6,\r\n\t\t\t\t\tclass: 'six',\r\n\t\t\t\t\tcolor: 'orange'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'OB7',\r\n\t\t\t\t\tvalue: 7,\r\n\t\t\t\t\tclass: 'seven',\r\n\t\t\t\t\tcolor: 'orange'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'OB8',\r\n\t\t\t\t\tvalue: 8,\r\n\t\t\t\t\tclass: 'eight',\r\n\t\t\t\t\tcolor: 'orange'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'OB9',\r\n\t\t\t\t\tvalue: 9,\r\n\t\t\t\t\tclass: 'nine',\r\n\t\t\t\t\tcolor: 'orange'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'OB10',\r\n\t\t\t\t\tvalue: 10,\r\n\t\t\t\t\tclass: 'ten',\r\n\t\t\t\t\tcolor: 'orange'\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\tresources: [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'JC09',\r\n\t\t\t\t\tclass: 'Joseph Barter',\r\n\t\t\t\t\tsymbol: 'fur',\r\n\t\t\t\t\tdescription: 'Pay 1 Canoe and move your Scout 5 spaces forward on the River.',\r\n\t\t\t\t\tstory: 'Also known as La Liberté, a private in the U.S. Army before being assigned duties as a boatman. However, he deserts soon afterwards.',\r\n\t\t\t\t\tstrength: 1,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tcanoe: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 5 river for 1 canoe.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\triver: 5\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC04',\r\n\t\t\t\t\tclass: 'Ebenezer Tuttle',\r\n\t\t\t\t\tsymbol: 'fur',\r\n\t\t\t\t\tdescription: 'Pay 1 Wood and take 1 Canoe.',\r\n\t\t\t\t\tstory: 'Private, recruited for the first part of the expedition up to Fort Mandan. He is sent back to Saint Louis with Pierre Chouteau’s party of fur traders.',\r\n\t\t\t\t\tstrength: 1,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\twood: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'receive 1 canoe for 1 wood',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tcanoe: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC05',\r\n\t\t\t\t\tclass: 'René Jessaume',\r\n\t\t\t\t\tsymbol: 'fur',\r\n\t\t\t\t\tdescription: 'Pay 3 Furs and take 1 Horse.',\r\n\t\t\t\t\tstory: 'He lived with his Indian wife and children in the Mandan chief ’s village. He helps the captains by providing them with information about the various chiefs and tribal politics.',\r\n\t\t\t\t\tstrength: 1,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tfur: 3\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'receive 1 horse for 3 fur.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\thorse: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC07',\r\n\t\t\t\t\tclass: 'Moses B. Reed',\r\n\t\t\t\t\tsymbol: 'fur',\r\n\t\t\t\t\tdescription: 'Pay 2 Wood and move your Scout 2 spaces forward on the River.',\r\n\t\t\t\t\tstory: 'Private, discharged from the Corps for having deserted and stolen weapons.',\r\n\t\t\t\t\tstrength: 1,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\twood: 2\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 2 river for 2 wood.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\triver: 2\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC24',\r\n\t\t\t\t\tclass: 'P. Antoine Tabeau',\r\n\t\t\t\t\tsymbol: 'fur',\r\n\t\t\t\t\tdescription: 'Pay 1 Wood and 1 Food and take 2 Canoes.',\r\n\t\t\t\t\tstory: 'French-Canadian fur-trader and explorer; provides useful information about Arikara Indian tribes.',\r\n\t\t\t\t\tstrength: 2,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\twood: 1,\r\n\t\t\t\t\t\t\tmeat: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'receive 2 canoes for 1 food and 1 wood.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tcanoe: 2\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC19',\r\n\t\t\t\t\tclass: 'John Hay',\r\n\t\t\t\t\tsymbol: 'fur',\r\n\t\t\t\t\tdescription: 'For each Strength that activates this card, choose one of the two resources: Fur or Wood, and collect it. (By activating this card three times, you can, for instance, collect Fur twice and Wood once.)',\r\n\t\t\t\t\tstory: 'As a merchant, fur trader, and Cahokia’s post- master, he provides information. Since he speaks French and English, he helps as an interpreter.',\r\n\t\t\t\t\tstrength: 2,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcollect: 'fur',\r\n\t\t\t\t\t\tshort: 'collect fur.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcollect: 'wood',\r\n\t\t\t\t\t\tshort: 'collect wood.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC22',\r\n\t\t\t\t\tclass: 'Black Moccasin',\r\n\t\t\t\t\tsymbol: 'fur',\r\n\t\t\t\t\tdescription: 'For each Strength that activates this card, choose one of the two resources: Equipment or Food, and collect it. (By activating this card three times, you can, for instance, collect Equipment twice and Food once.)',\r\n\t\t\t\t\tstory: 'Minitari chief, he captured Sacagawea from the Shoshone a few years earlier.',\r\n\t\t\t\t\tstrength: 2,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcollect: 'equipment',\r\n\t\t\t\t\t\tshort: 'collect equipment.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcollect: 'meat',\r\n\t\t\t\t\t\tshort: 'collect food.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC26',\r\n\t\t\t\t\tclass: 'Hawk\\'s Feather',\r\n\t\t\t\t\tsymbol: 'fur',\r\n\t\t\t\t\tdescription: 'Pay 1 Food and move your Scout 3 spaces forward on the River.',\r\n\t\t\t\t\tstory: 'Arikara chief, agrees to attempt peace with the Mandan.',\r\n\t\t\t\t\tstrength: 2,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tmeat: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 3 river for 1 food.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\triver: 3\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC48',\r\n\t\t\t\t\tclass: 'Coboway',\r\n\t\t\t\t\tsymbol: 'fur',\r\n\t\t\t\t\tdescription: 'Pay 1 Equipment, 1 Food, 1 Fur and 1 Wood and move your Scout 4 spaces forward in the Mountains.',\r\n\t\t\t\t\tstory: 'He is the only Clatsop leader to make recorded contact with the Expedition. He exchanges some goods, including a sea otter pelt, for fish hooks and a small bag of Shoshone tobacco.',\r\n\t\t\t\t\tstrength: 3,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tequipment: 1,\r\n\t\t\t\t\t\t\tfur: 1,\r\n\t\t\t\t\t\t\tmeat: 1,\r\n\t\t\t\t\t\t\twood: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 4 mountain for 1 of each basic.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tmountain: 4\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC47',\r\n\t\t\t\t\tclass: 'Old Toby',\r\n\t\t\t\t\tsymbol: 'fur',\r\n\t\t\t\t\tdescription: 'Pay 1 Canoe and 1 Horse and move your Scout 6 spaces forward, either on the River or in the Mountains; not both! If activated more than once, each multiple of 6 can be either River or Mountains.',\r\n\t\t\t\t\tstory: 'Shoshone guide, he is sent by Cameahwait to lead the Expedition across the Rockies. He guides Clark’s exploration of the Salmon River.',\r\n\t\t\t\t\tstrength: 3,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tcanoe: 1,\r\n\t\t\t\t\t\t\thorse: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 6 river for 1 canoe, and 1 horse.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\triver: 6\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tcanoe: 1,\r\n\t\t\t\t\t\t\thorse: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 6 mountain for 1 canoe, and 1 horse.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tmountain: 6\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC41',\r\n\t\t\t\t\tclass: 'Cameahwait',\r\n\t\t\t\t\tsymbol: 'fur',\r\n\t\t\t\t\tdescription: 'Pay 1 Canoe and take 1 Horse or pay 1 Horse and take 1 Canoe.',\r\n\t\t\t\t\tstory: 'Shoshone chief, he is Sacagawea’s brother. He provides Lewis and Clark hospitality and horses to repay them for reuniting him with his long-lost sister.',\r\n\t\t\t\t\tstrength: 3,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tcanoe: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'receive 1 horse for 1 canoe',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\thorse: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\thorse: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'receive 1 canoe for 1 horse',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tcanoe: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC10',\r\n\t\t\t\t\tclass: 'J. Baptiste Deschamps',\r\n\t\t\t\t\tsymbol: 'meat',\r\n\t\t\t\t\tdescription: 'Pay 1 Food and 1 Canoe and move your Scout 6 spaces forward on the River.',\r\n\t\t\t\t\tstory: 'As a French boatman, he is appointed foreman of the French boatmen in the red pirogue. He is among the men who, in April, 1805, navigate the keelboat downriver to St. Louis.',\r\n\t\t\t\t\tstrength: 1,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tcanoe: 1,\r\n\t\t\t\t\t\t\tmeat: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 6 river for 1 canoe and 1 food.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\triver: 6\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC11',\r\n\t\t\t\t\tclass: 'John Newman',\r\n\t\t\t\t\tsymbol: 'wood',\r\n\t\t\t\t\tstory: 'Recruited at Fort Massac, he is expelled from the expedition following his court-martial for (having uttered repeated expressions of a highly criminal and mutinous nature.',\r\n\t\t\t\t\tdescription: 'Pay 1 Food and move your Scout 1 space forward on the River or in the Mountains.',\r\n\t\t\t\t\tstrength: 1,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tmeat: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 1 river for 1 food.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\triver: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tmeat: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 1 mountain for 1 food.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tmountain: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC42',\r\n\t\t\t\t\tclass: 'Broken Arm',\r\n\t\t\t\t\tsymbol: 'meat',\r\n\t\t\t\t\tdescription: 'Pay 1 Equipment and take 1 Horse.',\r\n\t\t\t\t\tstroy: 'Nez Perce chief. Honest and generous, he gives the Corps horses and desires to make peace with the Shoshone.',\r\n\t\t\t\t\tstrength: 3,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tequipment: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'receive 1 horse for 1 equipment.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\thorse: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC32',\r\n\t\t\t\t\tclass: 'James Mackay',\r\n\t\t\t\t\tsymbol: 'meat',\r\n\t\t\t\t\tdescription: 'Pay 1 Horse and move your Scout forward 3 spaces, either on the River or in the Mountains; not both! If activated more than once, each multiple of 3 can be either River or Mountains.',\r\n\t\t\t\t\tstory: 'Fur trader, explorer, Scotsman, (perhaps the most widely travelled of the many traders met), he is the creator of the most complete Missouri River map used by Lewis & Clark.',\r\n\t\t\t\t\tstrength: 2,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\thorse: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 3 mountain for 1 horse',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tmountain: 3\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\thorse: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 3 river for 1 horse',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\triver: 3\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC21',\r\n\t\t\t\t\tclass: 'Dickson & Hancock',\r\n\t\t\t\t\tsymbol: 'meat',\r\n\t\t\t\t\tdescription: 'For each Strength that activates this card, choose one of the two resources: Food or Fur, and collect it. (By activating this card three times, you can, for instance, collect Food twice and Fur once.)',\r\n\t\t\t\t\tstory: 'Fur trappers, they meet the expedition in September,1806, during its return to Washington. They invite John Colter to join them as a trapper.',\r\n\t\t\t\t\tstrength: 2,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcollect: 'meat',\r\n\t\t\t\t\t\tshort: 'collect food.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcollect: 'fur',\r\n\t\t\t\t\t\tshort: 'collect fur.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC38',\r\n\t\t\t\t\tclass: 'Hugh Heney',\r\n\t\t\t\t\tsymbol: 'meat',\r\n\t\t\t\t\tdescription: 'For each Strength that activates this card, choose one of the three resources: Fur, Food or Wood. Then collect it. (By activating this card three times, you can, for instance, collect Fur once, Food once and Wood once.)',\r\n\t\t\t\t\tstory: 'Canadian fur trader, a «very sensible, intelligent man», he knows the Teton Sioux like no other white man. Heney sends some snakebite medicine to Lewis & Clark.',\r\n\t\t\t\t\tstrength: 3,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcollect: 'fur',\r\n\t\t\t\t\t\tshort: 'collect fur.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcollect: 'meat',\r\n\t\t\t\t\t\tshort: 'collect food.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcollect: 'wood',\r\n\t\t\t\t\t\tshort: 'collect wood.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC03',\r\n\t\t\t\t\tclass: 'Buffalo Medicine',\r\n\t\t\t\t\tsymbol: 'equipment',\r\n\t\t\t\t\tdescription: 'Pay 1 Food and take 1 Canoe.',\r\n\t\t\t\t\tstory: 'Teton Sioux third chief, involved in a power struggle. He meets the Expedition on the Bad River in September, 1804.',\r\n\t\t\t\t\tstrength: 1,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tmeat: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'receive 1 canoe for 1 food.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tcanoe: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC13',\r\n\t\t\t\t\tclass: 'John Dame',\r\n\t\t\t\t\tsymbol: 'equipment',\r\n\t\t\t\t\tdescription: 'Pay 2 Wood and move your Scout 1 space forward in the Mountains.',\r\n\t\t\t\t\tstory: 'Aged 19, fair-haired and blue-eyed, he joins the Corps for the 1rst part of the journey and comes back to Saint Louis in the spring of 1805. He has shot a white pelican.',\r\n\t\t\t\t\tstrength: 1,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\twood: 2\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 1 mountain for 2 wood.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tmountain: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC12',\r\n\t\t\t\t\tclass: 'Charles Mackenzie',\r\n\t\t\t\t\tsymbol: 'equipment',\r\n\t\t\t\t\tdescription: 'Pay 1 Fur and 1 Horse and move your Scout 3 spaces forward in the Mountains.',\r\n\t\t\t\t\tstory: 'Fur trader, he works for the North West Company. Along with Larocque, he is a frequent visitor to Fort Mandan during the winter of 1804-1805.',\r\n\t\t\t\t\tstrength: 1,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\thorse: 1,\r\n\t\t\t\t\t\t\tfur: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 6 river for 1 canoe and 1 food.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tmountain: 3\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC20',\r\n\t\t\t\t\tclass: 'Big White',\r\n\t\t\t\t\tsymbol: 'equipment',\r\n\t\t\t\t\tdescription: 'For each Strength that activates this card, choose one of the two resources: Equipment or Wood. Then collect it. (By activating this card three times, you can, for instance, collect Equipment twice and Wood once.)',\r\n\t\t\t\t\tstory: 'He is the principal chief of the lower Mandan village, nicknamed this way because of his size and complexion. He meets President Jefferson in Washington after the expedition',\r\n\t\t\t\t\tstrength: 2,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcollect: 'equipment',\r\n\t\t\t\t\t\tshort: 'collect equipment.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcollect: 'fur',\r\n\t\t\t\t\t\tshort: 'collect fur.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC34',\r\n\t\t\t\t\tclass: 'Pierre Dorion',\r\n\t\t\t\t\tsymbol: 'equipment',\r\n\t\t\t\t\tdescription: 'Pay 3 Furs and move your Scout forward 2 spaces in the Mountains.',\r\n\t\t\t\t\tstory: 'Married to a Yankton woman, he joins the expedition as an interpreter. In April 1805, he is sent back to St.Louis with chiefs of the Yankton, Omaha, Oto & Missouri tribes.',\r\n\t\t\t\t\tstrength: 2,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tfur: 3\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'receive 1 horse for 1 equipment.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tmountain: 2\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC43',\r\n\t\t\t\t\tclass: 'Comcomly',\r\n\t\t\t\t\tsymbol: 'equipment',\r\n\t\t\t\t\tdescription: 'Pay 1 Equipment, 1 Food, 1 Fur and 1 Wood and move your Scout 7 spaces forward on the River.',\r\n\t\t\t\t\tstory: 'Chinook chief, most powerful leader at the mouth of the Columbia, he is described as «a shrewd old savage with but one eye». He is friendly to the white explorers.',\r\n\t\t\t\t\tstrength: 3,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tequipment: 1,\r\n\t\t\t\t\t\t\tfur: 1,\r\n\t\t\t\t\t\t\twood: 1,\r\n\t\t\t\t\t\t\tmeat: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 7 river for 1 of each basic',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\triver: 7\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC37',\r\n\t\t\t\t\tclass: 'Régis Loisel',\r\n\t\t\t\t\tsymbol: 'equipment',\r\n\t\t\t\t\tdescription: 'For each Strength that activates this card, choose one of the three resources: Equipment, Food or Wood. Then collect it. (By activating this card three times, you can, for instance, collect Equipment once, Food once and Wood once.)',\r\n\t\t\t\t\tstory: 'French-Canadian fur trader and explorer at La Charette, on the Missouri River.',\r\n\t\t\t\t\tstrength: 3,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcollect: 'equipment',\r\n\t\t\t\t\t\tshort: 'collect equipment.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcollect: 'meat',\r\n\t\t\t\t\t\tshort: 'collect food.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\tcollect: 'wood',\r\n\t\t\t\t\t\tshort: 'collect wood.',\r\n\t\t\t\t\t\tbenefit: {}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC49',\r\n\t\t\t\t\tclass: 'Crow At Rest',\r\n\t\t\t\t\tsymbol: 'equipment',\r\n\t\t\t\t\tdescription: 'Pay 2 Furs and 2 Equipment and move your Scout 3 spaces forward in the Mountains.',\r\n\t\t\t\t\tstory: 'Grand Arikara chief, he is interested in trading buffalo skin. He assures the Corps that the Arikara would let them travel on in safety and that peace with the Mandan is desirable.',\r\n\t\t\t\t\tstrength: 3,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tequipment: 2,\r\n\t\t\t\t\t\t\tfur: 2\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 3 mountain for 2 equipment and 2 fur.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tmountain: 3\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC08',\r\n\t\t\t\t\tclass: 'John Robertson',\r\n\t\t\t\t\tsymbol: 'wood',\r\n\t\t\t\t\tdescription: 'Pay 2 Equipment and move your Scout 3 spaces forward on the River.',\r\n\t\t\t\t\tstory: 'Initially a corporal, Clark demotes him for having (no authority) over his men and failing to stop a fight at Camp Dubois. He’s probably the first man to leave the expedition.',\r\n\t\t\t\t\tstrength: 1,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tequipment: 2\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 3 river for 2 equipment.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\triver: 3\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC25',\r\n\t\t\t\t\tclass: 'Three Eagles',\r\n\t\t\t\t\tsymbol: 'wood',\r\n\t\t\t\t\tdescription: 'Pay 2 Equipment and take 1 Horse.',\r\n\t\t\t\t\tstory: 'Flathead chief, he meets the party in September, 1805, and welcomes, feeds, and swaps horses with the Corps of Discovery.',\r\n\t\t\t\t\tstrength: 2,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tequipment: 2\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'receive 1 horse for 2 equipment.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\thorse: 1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC27',\r\n\t\t\t\t\tclass: 'Man Crow',\r\n\t\t\t\t\tsymbol: 'wood',\r\n\t\t\t\t\tdescription: 'Pay 3 Wood and move your Scout 4 spaces forward on the River.',\r\n\t\t\t\t\tstory: 'Arikara chief, challenger to Crow at Rest’s civil authority',\r\n\t\t\t\t\tstrength: 2,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\twood: 3\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'travel 4 river for 3 wood.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\triver: 4\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: 'JC40',\r\n\t\t\t\t\tclass: 'Twisted Hair',\r\n\t\t\t\t\tsymbol: 'wood',\r\n\t\t\t\t\tdescription: 'Pay 1 Canoe and take 2 Canoes. If you activate this Character several times, you are not allowed to use the resources you get as a result of the first (or second) activation to trigger the next Action. You must use Canoes that had been previously held.',\r\n\t\t\t\t\tstory: 'Nez Perce chief, a «cheerful man with apparent sincerity», helps build dugout canoes',\r\n\t\t\t\t\tstrength: 3,\r\n\t\t\t\t\tabilities: [{\r\n\t\t\t\t\t\tcost: {\r\n\t\t\t\t\t\t\tcanoe: 1\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tshort: 'receive 2 canoes for 1 canoe.',\r\n\t\t\t\t\t\tbenefit: {\r\n\t\t\t\t\t\t\tcanoe: 2\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\twinner: [],\r\n\t\t\tget allCards() {\r\n\t\t\t\treturn [].concat(this.purple, this.yellow, this.cyan, this.orange, this.resources, this.winner);\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n]);\r\nmainApp.factory('ClassFactory', [\r\n\t'CardFactory',\r\n\tfunction CFactory(CF) {\r\n\t\t'use strict';\r\n\r\n\t\tconst allColors = ['yellow', 'cyan', 'orange', 'purple'];\r\n\t\tconst ClassFactory = {\r\n\t\t\tCorp: class Corp {\r\n\t\t\t\tconstructor() {\r\n\t\t\t\t\tthis.wood = 0;\r\n\t\t\t\t\tthis.energy = 0;\r\n\t\t\t\t\tthis.mineral = 0;\r\n\t\t\t\t\tthis.food = 0;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tDeck: class Deck {\r\n\t\t\t\tconstructor(color) {\r\n\t\t\t\t\tthis.cards = CF[color];\r\n\t\t\t\t\tthis.activeCardId = '';\r\n\t\t\t\t}\r\n\t\t\t\tget battleValue() {\r\n\t\t\t\t\treturn this.selectedCards.reduce((total, card) => total + card.value, 0);\r\n\t\t\t\t}\r\n\t\t\t\tget selectedCards() {\r\n\t\t\t\t\treturn this.heldCards.filter(card => card.selected);\r\n\t\t\t\t}\r\n\t\t\t\tget submittable() {\r\n\t\t\t\t\treturn this.selectedCards.length === 3;\r\n\t\t\t\t}\r\n\t\t\t\tget activeCard() {\r\n\t\t\t\t\treturn _.find(this.cards, {id: this.activeCardId});\r\n\t\t\t\t}\r\n\t\t\t\tget heldCards() {\r\n\t\t\t\t\treturn this.cards.filter(card => !card.played);\r\n\t\t\t\t}\r\n\t\t\t\tget playedCards() {\r\n\t\t\t\t\treturn this.cards.filter(card => card.played);\r\n\t\t\t\t}\r\n\t\t\t\tget highestHeldCardValue() {\r\n\t\t\t\t\treturn this.cards.reduce((value, card) => {\r\n\t\t\t\t\t\tif (!card.played) {\r\n\t\t\t\t\t\t\treturn Math.max(value, card.value);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t}, 0);\r\n\t\t\t\t}\r\n\t\t\t\tfindById(cardId) {\r\n\t\t\t\t\treturn _.find(this.cards, {id: cardId});\r\n\t\t\t\t}\r\n\t\t\t\treset() {\r\n\t\t\t\t\tthis.cards.map(card => {\r\n\t\t\t\t\t\tcard.played = false;\r\n\t\t\t\t\t\tcard.selected = false;\r\n\t\t\t\t\t\tcard.plays = 0;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tplay(cardInfo) {\r\n\t\t\t\t\tvar card = _.find(this.cards, {id: cardInfo.id});\r\n\r\n\t\t\t\t\tcard.played = true;\r\n\t\t\t\t}\r\n\t\t\t\tremove(cardInfo) {\r\n\t\t\t\t\tvar card = _.find(this.cards, {id: cardInfo.id}),\r\n\t\t\t\t\t\tidx = _.findIndex(this.cards, card);\r\n\r\n\t\t\t\t\tthis.cards.splice(idx, 1);\r\n\t\t\t\t}\r\n\t\t\t\tadd(card) {\r\n\t\t\t\t\tthis.cards.push(card);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tPlayer: class Player {\r\n\t\t\t\t/*\r\n\t\t\t\t * Player has a name, a color, a deck, and a corp\r\n\t\t\t\t */\r\n\t\t\t\tconstructor(options) {\r\n\t\t\t\t\tthis.name = options.name;\r\n\t\t\t\t\tthis.uid = options.uid;\r\n\t\t\t\t\tthis.color = options.color || allColors.splice(-1)[0];\r\n\t\t\t\t\tthis.corp = new ClassFactory.Corp();\r\n\t\t\t\t\tthis.deck = new ClassFactory.Deck(this.color);\r\n\t\t\t\t\tthis.idx = options.idx;\r\n\t\t\t\t\tthis.collectables = [];\r\n\t\t\t\t\tthis.payment = [];\r\n\t\t\t\t}\r\n\t\t\t\treset() {\r\n\t\t\t\t\tthis.collectables = [];\r\n\t\t\t\t\tthis.payment = [];\r\n\t\t\t\t\tthis.deck.reset();\r\n\t\t\t\t}\r\n\t\t\t\tplayCardSet(cardSet) {\r\n\t\t\t\t\tcardSet.forEach(card => {\r\n\t\t\t\t\t\tthis.playCard(card);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tplayCard(card) {\r\n\t\t\t\t\tthis.deck.play(card);\r\n\t\t\t\t}\r\n\t\t\t\tcollect(item) {\r\n\t\t\t\t\tthis.collectables.push(_.clone(item));\r\n\t\t\t\t}\r\n\t\t\t\t// },\r\n\r\n\t\t\t\t// User: class User {\r\n\t\t\t\t// \tconstructor() {}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn ClassFactory;\r\n\t}\r\n]);\r\nmainApp.factory('EventFactory', [\r\n\t'CardFactory',\r\n\t'FirebaseFactory',\r\n\t'ClassFactory',\r\n\tfunction EventFactory(CF, FF, Class) {\r\n\t\t'use strict';\r\n\r\n\t\t/**\r\n\t\t * Note: $s needs to be defined. This can be done by setting this entire\r\n\t\t * factory as a property of $s and calling the methods from that property\r\n\t\t */\r\n\t\tvar EF = {\r\n\t\t\tgameCreated: resolve => {\r\n\t\t\t\t$s.state = 'startGame';\r\n\t\t\t\tresolve();\r\n\t\t\t},\r\n\t\t\tstartGame: resolve => {\r\n\t\t\t\tvar users = FF.getFBObject('users');\r\n\t\t\t\tusers.$loaded(() => {\r\n\t\t\t\t\t$s.activeGame.playerIds.map(id => {\r\n\t\t\t\t\t\tvar user = users[id];\r\n\t\t\t\t\t\t$s.allPlayers.push(new Class.Player({\r\n\t\t\t\t\t\t\tname: user.firstName,\r\n\t\t\t\t\t\t\tuid: user.uid,\r\n\t\t\t\t\t\t\tidx: $s.allPlayers.length + 1\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$s.activeGame.active = true;\r\n\t\t\t\t\t$s.user = _.find($s.allPlayers, {uid: $s.currentUser.uid});\r\n\t\t\t\t\tEF.chooseBattle(resolve);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// if a function uses `this` for the event, it cannot be an arrow function\r\n\t\t\tplayCard: function(resolve) {\r\n\t\t\t\tvar card = $s.currentPlayer.deck.findById(this.cardId);\r\n\r\n\t\t\t\tif ($s.currentPlayer.playCard(card)) {\r\n\t\t\t\t\tconsole.log(`Event ${$s.eventTracker}:`, $s);\r\n\t\t\t\t\t$s.state = 'strength';\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcloseModal: resolve => {\r\n\t\t\t\t$s.modalInstance.close();\r\n\t\t\t\tresolve();\r\n\t\t\t},\r\n\t\t\tchooseBattle: resolve => {\r\n\t\t\t\t$s.state = 'chooseBattle';\r\n\t\t\t\t$s.activeGame.message = {};\r\n\t\t\t\tresolve();\r\n\t\t\t},\r\n\t\t\tsubmitBattle: function(resolve) {\r\n\t\t\t\tif (!$s.battleHistory[this.battleCount]) {\r\n\t\t\t\t\t$s.battleHistory[this.battleCount] = {};\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$s.battleHistory[this.battleCount][this.uid] = this.cards;\r\n\r\n\t\t\t\tif (_.keys($s.battleHistory[this.battleCount]).length == $s.allPlayers.length) {\r\n\t\t\t\t\tEF.battle(this.battleCount, resolve);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbattle: (count, resolve) => {\r\n\t\t\t\t_.mapKeys($s.battleHistory[count], (cards, uid) => {\r\n\t\t\t\t\tvar player = _.find($s.allPlayers, {uid});\r\n\r\n\t\t\t\t\tplayer.battlePower = cards.reduce((total, card) => total + card.value, 0);\r\n\t\t\t\t\tplayer.winner = false;\r\n\t\t\t\t\tplayer.playCardSet(cards);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tEF.determineWinner(resolve);\r\n\t\t\t},\r\n\t\t\tdetermineWinner: resolve => {\r\n\t\t\t\t$s.allPlayers.sort((a, b) => b.battlePower - a.battlePower);\r\n\r\n\t\t\t\t$s.allPlayers.forEach((player, i) => {\r\n\t\t\t\t\tvar nextPlayer = $s.allPlayers[i + 1] || {};\r\n\r\n\t\t\t\t\tif (i === 0) {\r\n\t\t\t\t\t\tplayer.winner = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (player.battlePower == nextPlayer.battlePower) {\r\n\t\t\t\t\t\tplayer.duplicateBattlePower = true;\r\n\t\t\t\t\t\tnextPlayer.duplicateBattlePower = true;\r\n\t\t\t\t\t\tnextPlayer.winner = player.winner;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$s.state = 'determineWinner';\r\n\t\t\t\tresolve();\r\n\t\t\t},\r\n\t\t\ttakeResource: function(resolve) {\r\n\t\t\t\t// take a resource\r\n\t\t\t\tresolve();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn EF;\r\n\t}\r\n]);\r\nmainApp.factory('FirebaseFactory', [\r\n\t'$firebaseArray',\r\n\t'$firebaseObject',\r\n\tfunction FirebaseFactory($fbArray, $fbObject) {\r\n\t\t'use strict';\r\n\t\tvar FB = null;\r\n\t\tvar FF = {\r\n\t\t\t// Firebase methods\r\n\t\t\tgetFB: childPath => {\r\n\t\t\t\tif (!FB) {\r\n\t\t\t\t\tFB = firebase.database().ref();\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn childPath ? FB.child(childPath) : FB;\r\n\t\t\t},\r\n\r\n\t\t\tgetFBArray: childPath => $fbArray(FF.getFB(childPath)),\r\n\r\n\t\t\tgetFBObject: childPath => $fbObject(FF.getFB(childPath)),\r\n\r\n\t\t\tgetAuth: childPath => $firebaseAuth(FF.getFB(childPath)),\r\n\r\n\t\t\tsetFB: (childPath, value) => {\r\n\t\t\t\tvar ref = FF.getFB(childPath);\r\n\t\t\t\tref.set(value);\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tgoogleLogin: (err, success) => {\r\n\t\t\t\tvar provider = new firebase.auth.GoogleAuthProvider();\r\n\t\t\t\tfirebase.auth().signInWithPopup(provider).then(result => {\r\n\t\t\t\t\tsuccess(result.user);\r\n\t\t\t\t}).catch(error => {\r\n\t\t\t\t\terr(error);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tfacebookLogin: (err, success) => {\r\n\t\t\t\tvar provider = new firebase.auth.FacebookAuthProvider();\r\n\t\t\t\tprovider.addScope('public_profile');\r\n\t\t\t\tfirebase.auth().signInWithPopup(provider).then(function(result) {\r\n\t\t\t\t\t// This gives you a Facebook Access Token. You can use it to access the Facebook API.\r\n\t\t\t\t\t//var token = result.credential.accessToken;\r\n\t\t\t\t\t// The signed-in user info.\r\n\t\t\t\t\t//var user = result.user;\r\n\t\t\t\t\tsuccess(result.user);\r\n\t\t\t\t}).catch(function(error) {\r\n\t\t\t\t\t// Handle Errors here.\r\n\t\t\t\t\t//var errorCode = error.code;\r\n\t\t\t\t\t//var errorMessage = error.message;\r\n\t\t\t\t\t// The email of the user's account used.\r\n\t\t\t\t\t//var email = error.email;\r\n\t\t\t\t\t// The firebase.auth.AuthCredential type that was used.\r\n\t\t\t\t\t//var credential = error.credential;\r\n\t\t\t\t\t// ...\r\n\t\t\t\t\terr(error);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn FF;\r\n\t}\r\n]);\r\n\r\nvar mc = {\r\n\tpluralize: str => str.replace(/y$/, 'ie') + 's',\r\n\r\n\tcamelToTitle: str => _.capitalize(str.replace(/([A-Z])/g, ' $1')).trim(),\r\n\r\n\trandomDigits: (min, max) => {\r\n\t\tmin = min === undefined ? 1 : min;\r\n\t\tmax = max || 999;\r\n\r\n\t\treturn Math.floor(Math.random() * (max - min + 1) + min);\r\n\t},\r\n\r\n\talphabet: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split(''),\r\n\r\n\tisAngularObjectEqual: (object1, object2) => _.isEqual(_.omit(object1, '$$hashKey'), _.omit(object2, '$$hashKey')),\r\n\r\n\texpandArray: (array, times) => {\t//\tturns [1,2,3] into [1,2,3,1,2,3,1,2,3];\r\n\t\ttimes = times || 3;\t//\tdefault number of times to expand it by\r\n\r\n\t\tvar expandedArray = [];\r\n\r\n\t\tfor (var i = 0; i < times; i++) {\r\n\t\t\texpandedArray = expandedArray.concat(angular.copy(array));\r\n\t\t}\r\n\r\n\t\treturn expandedArray;\r\n\t},\r\n\r\n\tcalculateAge: (dateOfBirth) => {\r\n\t\tvar age;\r\n\r\n\t\tif (dateOfBirth) {\r\n\t\t\tvar year = Number(dateOfBirth.substr(0, 4));\r\n\t\t\tvar month = Number(dateOfBirth.substr(5, 2)) - 1;\r\n\t\t\tvar day = Number(dateOfBirth.substr(8, 2));\r\n\t\t\tvar today = new Date();\r\n\t\t\tage = today.getFullYear() - year;\r\n\r\n\t\t\tif (today.getMonth() < month || (today.getMonth() == month && today.getDate() < day)) {\r\n\t\t\t\tage--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn age || 0;\r\n\t}\r\n};\r\n"]}